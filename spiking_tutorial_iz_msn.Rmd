---
title: "spiking network tutorial - Izhikevich MSN"
author: "Author: Matthew J. Crossley"
date: "Last update: `r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: false
    toc_float:
        collapsed: true
        smooth_scroll: true
    toc_depth: 4
    fig_caption: yes
    number_sections: false
    theme: cerulean
fontsize: 14pt
---

```{python, engine.path = '/Users/mq20185996/miniconda3/bin/python'}

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# The Izhikevich model
C = 50
vr = -80
vt = -25
k = 1
a = 0.01
b = -20
c = -55
d = 150
vpeak = 40

n_steps = 900

input_amp = 600
E = np.concatenate((np.zeros(n_steps // 3), input_amp * np.ones(n_steps // 3),
                    np.zeros(n_steps // 3)))

v = np.zeros(n_steps)
u = np.zeros(n_steps)
o = np.zeros(n_steps)

v[0] = vr

alpha = 0.01
beta = 1.0
o = np.zeros(n_steps)

for i in range(n_steps - 1):
    v[i + 1] = v[i] + tau * (k * (v[i] - vr) * (v[i] - vt) - u[i] + E[i]) / C
    u[i + 1] = u[i] + tau * a * (b * (v[i] - vr) - u[i])
    o[i + 1] = o[i] + alpha * (np.heaviside(v[i] - vt, vt) - o[i])

    if v[i + 1] >= vpeak:
        v[i] = vpeak
        v[i + 1] = c
        u[i + 1] = u[i + 1] + d

fig, ax = plt.subplots(nrows=2, ncols=1)
ax[0].plot(np.arange(0, n_steps, 1), E)
ax[0].set_ylabel('Input')

ax[1].plot(np.arange(0, n_steps, 1), v, 'C0')
ax[1].set_ylabel('Membrane V')

ax1 = ax[1].twinx()
ax1.plot(np.arange(0, n_steps, 1), o, 'C1')
ax1.set_ylabel('Output')
ax1.yaxis.label.set_color('C1')

plt.tight_layout()
plt.show()

```
