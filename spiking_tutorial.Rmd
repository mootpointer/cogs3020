---
title: "spiking network tutorial"
author: "Author: Matthew J. Crossley"
date: "Last update: `r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: false
    toc_float:
        collapsed: true
        smooth_scroll: true
    toc_depth: 4
    fig_caption: yes
    number_sections: false
    theme: cerulean
fontsize: 14pt
---

```{python, engine.path = '/Users/mq20185996/miniconda3/bin/python'}

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

tau = 1
C = 25
vr = -60
vt = -40
k = 0.7
c = -50
vpeak = 35

n_steps = 900

input_amp = 100
E = np.concatenate((np.zeros(n_steps // 3), input_amp * np.ones(n_steps // 3),
                    np.zeros(n_steps // 3)))

v = np.zeros(n_steps)
v[0] = vr

alpha = 0.01
o = np.zeros(n_steps)

for i in range(n_steps - 1):
    v[i + 1] = v[i] + tau * (k * (v[i] - vr) * (v[i] - vt) + E[i]) / C
    o[i + 1] =  o[i] + alpha * ((v[i] - vr) - o[i])
    if v[i + 1] >= vpeak:
        v[i] = vpeak
        v[i + 1] = c

fig, ax = plt.subplots(nrows=3, ncols=1, figsize=(10, 4))
ax[0].plot(np.arange(0, n_steps, 1), E)
ax[1].plot(np.arange(0, n_steps, 1), v)
ax[2].plot(np.arange(0, n_steps, 1), o)
plt.show()

```
